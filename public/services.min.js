angular.module("app.services",["ngResource","ngStorage","angular-jwt"]).provider("baseUrl",function(){var e=this;this.url=window.location.origin,this.set=function(e){this.url=e},this.get=function(){return e.url},this.$get=[function(){return{get:function(){return e.url}}}]}).factory("API",["$resource","baseUrl",function(e,t){var n=e(t.get()+"/api/users/:id",{id:"@_id"},{login:{method:"POST",url:t.get()+"/auth/login/:method",params:{method:"@method"},cache:!0},signup:{method:"POST",url:t.get()+"/auth/signup",cache:!0},resetPassword:{method:"POST",url:t.get()+"/auth/reset"}});return angular.extend(n.prototype,{username:function(){return this.identities.local?this.identities.local.username:null},firstName:function(){var e=this.identities.facebook,t=this.identities.google;return{facebook:e?e.first_name:null,google:t?t.first_name:null}},lastName:function(){var e=this.identities.facebook,t=this.identities.google;return{facebook:e?e.last_name:null,google:t?t.last_name:null}},picture:function(){var e=this.identities.facebook,t=this.identities.google;return{facebook:e?e.picture:null,google:t?t.picture:null}},email:function(){var e=this.identities.facebook,t=this.identities.google;return{facebook:e?e.email:null,google:t?t.email:null}},birthday:function(){var e=this.identities.facebook;return{facebook:e?e.birthday:null}}}),{User:n}}]).service("Auth",["$q","Token","API",function(e,t,n){var r=this;return r.user=null,this.login=function(e){return n.User.login(e).$promise.then(function(e){return r.user=e})},this.signup=function(e,t){return n.User.signup({username:e,password:t}).$promise.then(function(e){return r.user=e})},this.logout=function(){r.user=null,t.clear()},this.currentUser=function(){return!r.user&&t.get()&&(r.user=n.User.get({id:t.get().subject})),r.user},this}]).service("Token",["$localStorage","jwtHelper",function(e,t){var n=this;return this.get=function(n){var r=e.token;if(n)return r;try{return t.decodeToken(r)}catch(i){}},this.set=function(t){e.token=t},this.clear=function(){n.set()},this}]).factory("jwtResponseInterceptor",["$q","Token",function(e,t){return{response:function(e){try{var n=e.headers("Authorization").split(" ")[1];n&&t.set(n)}catch(r){}return e},responseError:function(n){switch(n.status){case 401:console.warn(401),t.clear();break;case 403:console.warn(403)}return e.reject(n)}}}]).config(["$httpProvider","jwtInterceptorProvider",function(e,t){t.tokenGetter=["config","Token",function(e,t){return".html"==e.url.substr(e.url.length-5)?null:t.get(!0)}]}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzLm1pbi5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicHJvdmlkZXIiLCJzZWxmIiwidGhpcyIsInVybCIsIndpbmRvdyIsImxvY2F0aW9uIiwib3JpZ2luIiwic2V0IiwiZ2V0IiwiJGdldCIsImZhY3RvcnkiLCIkcmVzb3VyY2UiLCJiYXNlVXJsIiwiVXNlclJlc291cmNlIiwiaWQiLCJsb2dpbiIsIm1ldGhvZCIsInBhcmFtcyIsImNhY2hlIiwic2lnbnVwIiwicmVzZXRQYXNzd29yZCIsImV4dGVuZCIsInByb3RvdHlwZSIsInVzZXJuYW1lIiwiaWRlbnRpdGllcyIsImxvY2FsIiwiZmlyc3ROYW1lIiwiZmFjZWJvb2siLCJnb29nbGUiLCJmaXJzdF9uYW1lIiwibGFzdE5hbWUiLCJsYXN0X25hbWUiLCJwaWN0dXJlIiwiZW1haWwiLCJiaXJ0aGRheSIsIlVzZXIiLCJzZXJ2aWNlIiwiJHEiLCJUb2tlbiIsIkFQSSIsInVzZXIiLCJsb2dpbkRhdGEiLCIkcHJvbWlzZSIsInRoZW4iLCJwYXNzd29yZCIsImxvZ291dCIsImNsZWFyIiwiY3VycmVudFVzZXIiLCJzdWJqZWN0IiwiJGxvY2FsU3RvcmFnZSIsImp3dEhlbHBlciIsInJhdyIsInRva2VuIiwiZGVjb2RlVG9rZW4iLCJlIiwicmVzcG9uc2UiLCJoZWFkZXJzIiwic3BsaXQiLCJyZXNwb25zZUVycm9yIiwicmVqZWN0aW9uIiwic3RhdHVzIiwiY29uc29sZSIsIndhcm4iLCJyZWplY3QiLCJjb25maWciLCIkaHR0cFByb3ZpZGVyIiwiand0SW50ZXJjZXB0b3JQcm92aWRlciIsInRva2VuR2V0dGVyIiwic3Vic3RyIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiQUFHQUEsUUFBUUMsT0FBTyxnQkFDWCxhQUNBLFlBQ0EsZ0JBRUNDLFNBQVMsVUFBVyxXQUNqQixHQUFJQyxHQUFPQyxJQUVYQSxNQUFLQyxJQUFNQyxPQUFPQyxTQUFTQyxPQUUzQkosS0FBS0ssSUFBTSxT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LFNBQVU2QyxHQUNqQkgsRUFBY0csTUFBUUEsR0FHMUJsRCxLQUFLNEMsTUFBUSxXQUNUN0MsRUFBS00sT0FHRkwsUUFFVlEsUUFBUSwwQkFBMkIsS0FBTSxRQUFTLFNBQVUyQixFQUFJQyxHQUM3RCxPQUNJaUIsU0FBVSxTQUFVQSxHQUNoQixJQUNJLEdBQUlILEdBQVFHLEVBQVNDLFFBQVEsaUJBQWlCQyxNQUFNLEtBQUssRUFDckRMLElBQ0FkLEVBQU0vQixJQUFJNkMsR0FDaEIsTUFBT0UsSUFFVCxNQUFPQyxJQUVYRyxjQUFlLFNBQVVDLEdBQ3JCLE9BQVFBLEVBQVVDLFFBQ2QsSUFBSyxLQUVEQyxRQUFRQyxLQUFLLEtBQ2J4QixFQUFNUSxPQUVOLE1BQ0osS0FBSyxLQUVEZSxRQUFRQyxLQUFLLEtBR3JCLE1BQU96QixHQUFHMEIsT0FBT0osUUFJNUJLLFFBQVEsZ0JBQWlCLHlCQUEwQixTQUFVQyxFQUFlQyxHQUN6RUEsRUFBdUJDLGFBQWUsU0FBVSxRQUFTLFNBQVVILEVBQVExQixHQUV2RSxNQUFnRCxTQUE1QzBCLEVBQU83RCxJQUFJaUUsT0FBT0osRUFBTzdELElBQUlrRSxPQUFTLEdBQy9CLEtBR0ovQixFQUFNOUIsS0FBSSIsImZpbGUiOiJzZXJ2aWNlcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBNdWxpIFl1bHphcnkgb24gMjMtSnVuLTE2LlxyXG4gKi9cclxuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycsIFtcclxuICAgICduZ1Jlc291cmNlJyxcclxuICAgICduZ1N0b3JhZ2UnLFxyXG4gICAgJ2FuZ3VsYXItand0J1xyXG5dKVxyXG4gICAgLnByb3ZpZGVyKCdiYXNlVXJsJywgZnVuY3Rpb24gYmFzZVVybFByb3ZpZGVyKCkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy51cmwgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luO1xyXG5cclxuICAgICAgICB0aGlzLnNldCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAgICAgdGhpcy51cmwgPSB1cmw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzZWxmLnVybDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLiRnZXQgPSBbZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYudXJsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dXHJcbiAgICB9KVxyXG4gICAgLmZhY3RvcnkoJ0FQSScsIFsnJHJlc291cmNlJywgJ2Jhc2VVcmwnLCBmdW5jdGlvbiAoJHJlc291cmNlLCBiYXNlVXJsKSB7XHJcbiAgICAgICAgdmFyIFVzZXJSZXNvdXJjZSA9ICRyZXNvdXJjZShiYXNlVXJsLmdldCgpICsgJy9hcGkvdXNlcnMvOmlkJywge2lkOiAnQF9pZCd9LCB7XHJcbiAgICAgICAgICAgIGxvZ2luOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgIHVybDogYmFzZVVybC5nZXQoKSArICcvYXV0aC9sb2dpbi86bWV0aG9kJyxcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0BtZXRob2QnXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgY2FjaGU6IHRydWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2lnbnVwOiB7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgICAgIHVybDogYmFzZVVybC5nZXQoKSArICcvYXV0aC9zaWdudXAnLFxyXG4gICAgICAgICAgICAgICAgY2FjaGU6IHRydWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVzZXRQYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGJhc2VVcmwuZ2V0KCkgKyAnL2F1dGgvcmVzZXQnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgYW5ndWxhci5leHRlbmQoVXNlclJlc291cmNlLnByb3RvdHlwZSwge1xyXG4gICAgICAgICAgICB1c2VybmFtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWRlbnRpdGllcy5sb2NhbCA/IHRoaXMuaWRlbnRpdGllcy5sb2NhbC51c2VybmFtZSA6IG51bGxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZmlyc3ROYW1lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmFjZWJvb2sgPSB0aGlzLmlkZW50aXRpZXMuZmFjZWJvb2ssIGdvb2dsZSA9IHRoaXMuaWRlbnRpdGllcy5nb29nbGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhY2Vib29rOiBmYWNlYm9vayA/IGZhY2Vib29rLmZpcnN0X25hbWUgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZTogZ29vZ2xlID8gZ29vZ2xlLmZpcnN0X25hbWUgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhc3ROYW1lOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmFjZWJvb2sgPSB0aGlzLmlkZW50aXRpZXMuZmFjZWJvb2ssIGdvb2dsZSA9IHRoaXMuaWRlbnRpdGllcy5nb29nbGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhY2Vib29rOiBmYWNlYm9vayA/IGZhY2Vib29rLmxhc3RfbmFtZSA6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgZ29vZ2xlOiBnb29nbGUgPyBnb29nbGUubGFzdF9uYW1lIDogbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwaWN0dXJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmFjZWJvb2sgPSB0aGlzLmlkZW50aXRpZXMuZmFjZWJvb2ssIGdvb2dsZSA9IHRoaXMuaWRlbnRpdGllcy5nb29nbGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhY2Vib29rOiBmYWNlYm9vayA/IGZhY2Vib29rLnBpY3R1cmUgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGdvb2dsZTogZ29vZ2xlID8gZ29vZ2xlLnBpY3R1cmUgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVtYWlsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmFjZWJvb2sgPSB0aGlzLmlkZW50aXRpZXMuZmFjZWJvb2ssIGdvb2dsZSA9IHRoaXMuaWRlbnRpdGllcy5nb29nbGU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhY2Vib29rOiBmYWNlYm9vayA/IGZhY2Vib29rLmVtYWlsIDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBnb29nbGU6IGdvb2dsZSA/IGdvb2dsZS5lbWFpbCA6IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYmlydGhkYXk6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmYWNlYm9vayA9IHRoaXMuaWRlbnRpdGllcy5mYWNlYm9vaztcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmFjZWJvb2s6IGZhY2Vib29rID8gZmFjZWJvb2suYmlydGhkYXkgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgVXNlcjogVXNlclJlc291cmNlXHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLnNlcnZpY2UoJ0F1dGgnLCBbJyRxJywgJ1Rva2VuJywgJ0FQSScsIGZ1bmN0aW9uICgkcSwgVG9rZW4sIEFQSSkge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLnVzZXIgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmxvZ2luID0gZnVuY3Rpb24gKGxvZ2luRGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gQVBJLlVzZXIubG9naW4obG9naW5EYXRhKS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi51c2VyID0gdXNlcjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zaWdudXAgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBUEkuVXNlci5zaWdudXAoe1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH0pLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLnVzZXIgPSBudWxsO1xyXG4gICAgICAgICAgICBUb2tlbi5jbGVhcigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VsZi51c2VyICYmIFRva2VuLmdldCgpKVxyXG4gICAgICAgICAgICAgICAgc2VsZi51c2VyID0gQVBJLlVzZXIuZ2V0KHtpZDogVG9rZW4uZ2V0KCkuc3ViamVjdH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gc2VsZi51c2VyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfV0pXHJcbiAgICAuc2VydmljZSgnVG9rZW4nLCBbJyRsb2NhbFN0b3JhZ2UnLCAnand0SGVscGVyJywgZnVuY3Rpb24gKCRsb2NhbFN0b3JhZ2UsIGp3dEhlbHBlcikge1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAocmF3KSB7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9ICRsb2NhbFN0b3JhZ2UudG9rZW47XHJcbiAgICAgICAgICAgIGlmIChyYXcpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gand0SGVscGVyLmRlY29kZVRva2VuKHRva2VuKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgJGxvY2FsU3RvcmFnZS50b2tlbiA9IHRva2VuO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2V0KCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XSlcclxuICAgIC5mYWN0b3J5KCdqd3RSZXNwb25zZUludGVyY2VwdG9yJywgWyckcScsICdUb2tlbicsIGZ1bmN0aW9uICgkcSwgVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXNwb25zZTogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlc3BvbnNlLmhlYWRlcnMoJ0F1dGhvcml6YXRpb24nKS5zcGxpdCgnICcpWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW4uc2V0KHRva2VuKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVzcG9uc2VFcnJvcjogZnVuY3Rpb24gKHJlamVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZWplY3Rpb24uc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERlYXV0aGVudGljYXRlIHRoZSBnbG9iYWwgdXNlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oNDAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVG9rZW4uY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9BdXRoLmxvZ291dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQwMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHVuYXV0aG9yaXplZCBiZWhhdmlvdXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKDQwMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKVxyXG4gICAgLmNvbmZpZyhbJyRodHRwUHJvdmlkZXInLCAnand0SW50ZXJjZXB0b3JQcm92aWRlcicsIGZ1bmN0aW9uICgkaHR0cFByb3ZpZGVyLCBqd3RJbnRlcmNlcHRvclByb3ZpZGVyKSB7XHJcbiAgICAgICAgand0SW50ZXJjZXB0b3JQcm92aWRlci50b2tlbkdldHRlciA9IFsnY29uZmlnJywgJ1Rva2VuJywgZnVuY3Rpb24gKGNvbmZpZywgVG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gU2tpcCBhdXRoZW50aWNhdGlvbiBmb3IgYW55IHJlcXVlc3RzIGVuZGluZyBpbiAuaHRtbFxyXG4gICAgICAgICAgICBpZiAoY29uZmlnLnVybC5zdWJzdHIoY29uZmlnLnVybC5sZW5ndGggLSA1KSA9PSAnLmh0bWwnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIFRva2VuLmdldCh0cnVlKTtcclxuICAgICAgICB9XTtcclxuICAgIH1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
